# Givetel/Contactspace Automation Tools
This repository is designed to integrate Givetel's business operations with Contactspace's API tools. This is a public version of the full automation suite that contains no sensitive information.

## Setup
Before using the toolkit, some steps are required.
* You can install all dependent packages using the below.
````
pip install -r utils/requirements.txt
````
* You need to set up a Secrets folder with sensitive keys, passwords etc. This should live in your Givetel_Automation_Public directory and should contain .json files with the sensitive data. You should structure your json files as such:
1. Secrets/cs_credentials.json
````json
{"CS_USER": "your CS username", "CS_PASS": "your CS password", "CS_API": "your CS API key"}
````
Currently this is the only senstive information required in the public version. If you try to run the code before setting this up, a separate script will run to help you create it.

## Resources Folder
This automation is designed to be usable for non-programmers in the future, so most of the top-level control is done using data in the Resources folder.
This folder contains .xlsx files that anyone should be able to edit. Below are explanations of the functionality of each resource.
1. GiveTel_skillid.xlsx - This file contains all initiative names, initiative ID's, skill ID's, CPC's, Conversion targets and oldest open batch months. When a new campaign is added, it should be added as a row in this spreadsheet with all the relevant information.
2. Givetel_Users.xlsx - This file is automatically generated from the CS API, and contains all users in Givetel's CS system and their user ids.
3. headers.xlsx - This file is maintained by the user similarly to Givetel_skillid. When downloading datasets, some methods in this toolkit have a "transform_headers" parameter. This parameter uses headers.xlsx, and essentially transforms any column headers contained in row 2 and below to the correspending label in row 1. Ie if a header is called "AcqSource" it will be transformed to "Acq Source".
4. outcome_groups - This file is maintained by the user and contains all possible outcomes of a call in column B, with their corresponding outcome group in column A. This allows for the streamlining of outcomes to their respective groups. Outcome groups denote the following:
  * Answer Machine: Neutral outcome, no response.
  * Call Back - Agent: Neutral outcome, prospect to be called back by agent.
  * Call Back - Queue: Neutral outcome, prospect to be called back by anyone.
  * Chargeable: Negative outcome, prospect has been contacted and doesn't want to donate.
  * IR & NS: Negative outcome, prospect immediately shut down the call or should not have been passed to us in the first place.
  * Double Gift: Positive outcome, should count as two confirms.
  * Regular Gifts: Postivie outcome, prospect has set up a donation.
  * Unchargeable: Includes wrong numbers, disconnected numbers, underage supporters and any other completes that we cannot charge the client for.
  * Removal: A record has been removed from the system and should not be included in results or data volume calculations.
  * New Record: An unattempted record.
5. Contactspace's old API documentation is also included for methods that are still relying on this API. Postman documentation for the newer Thunder API can be found at https://documenter.getpostman.com/view/14510675/Tzz4Qyp5

## Utils Folder
A package that helps with first-time setup and setting constants to be referred to throughout the program. Most of the scripts in here should be left alone, but you can change your temp folder names in utils/settings.py if desired.

## Methods Folder
A package containing a variety of useful methods. The methods are divided between a variety of categorized scripts them in an attempt to increase simplicity.
1. cs_api.py includes all methods that directly invoke the contactspace API.
2. datetime.py includes utility methods to manipulate dates.
3. file_management.py includes utility methods like deleting all files from a folder etc.
4. gt.py contains methods useful for generating standard Givetel reports.
5. headers.py contains methods that access the Resources/headers.xlsx sheet.
6. outcomes.py contains methods that access the Resources/outcome_groups.xlsx sheet.
7. pandas.py contains logic for pandas algorithms. Some of these are quite extensive and used for generating niche report types.
8. selenium.py contains logic for selenium algorithms, this was the first solution to automatically generating daily results.
9. skillid.py contains methods that access the Resources/GiveTel_skillid.xlsx sheet.
10. strings.py contains methods for string manipulation.
11. users.py contains methods for accessing and updating staff information.

## Temp & Logs
These folders should be generated in the process of running the code. Temp is designed for outputted data exports, list reports etc to be outputted to. Logs is a record of anything raised by the error logging decorator, this is still in the early days of its implementation and could be cleaner.

## Closing Notes
This work is the intellectual property of Givetel & Jesse Williams, and any use or modification of the code should be raised with the intellectual property owners. Please contact jesse@givetel.com for any further questions on usage or implementation of these tools.